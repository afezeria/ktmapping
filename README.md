# ktmapping

ktmapping 是基于ksp实现的kotlin专用的类mapstruct的映射工具

# 功能

- 从Map/ResultSet映射到实体类
- 从Map/ResultSet/实体类更新实体类

# 特性

- Map/ResultSet映射到实体类时根据配置的命名风格自动映射Map/Result中的属性
- 来源对象的多个字段映射到目标对象的一个字段
- 来源对象的一个字段映射到目标对象的多个字段
- 编译期类型安全

## 基本规则

默认映射规则

- 实体类 到 实体类
    - 根据名称映射，映射中的来源对象的字段必须有 getter 函数,目标对象的对应字段必须有 setter 函数
    - source的类型必须等于target的类型或为target的类型的子类型

- Map 到 实体类
    - Map 的值的范型类型必须为目标对象类型中所有映射的字段/构造器参数的类型的父类型，推荐用Any
    - 默认目标对象中的所有可变字段和构造器参数在Map中都存在对应的属性

- ResultSet 到 实体类
    - 默认目标对象中的所有可变字段和构造器参数在ResultSet中都存在对应的属性

映射函数要求

- 参数个数为1,类型为Map/ResultSet/自定义实体类
- 返回值为自定义实体类
- 创建目标对象时选择的构造器的规则：有主构造器用主构造器，没有主构造器时取参数最少的构造器
- 构造器可见性必须为public

更新函数要求

- 参数个数为2，第一个参数类型为Map/ResultSet/自定义实体类，第二个参数为自定义实体类
- 返回值为Unit
- 目标对象有可变属性

